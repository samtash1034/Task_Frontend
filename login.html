<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>登入頁面</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  </head>
  <body
    class="bg-light d-flex justify-content-center align-items-center vh-100"
  >
    <div class="card shadow p-4" style="width: 400px">
      <h3 class="text-center mb-4">系統登入</h3>
      <div class="mb-3">
        <label for="account" class="form-label">帳號</label>
        <input
          type="text"
          class="form-control"
          id="account"
          placeholder="請輸入帳號"
          required
        />
      </div>
      <div class="mb-3">
        <label for="password" class="form-label">密碼</label>
        <input
          type="password"
          class="form-control"
          id="password"
          placeholder="請輸入密碼"
          required
        />
      </div>
      <div class="d-grid">
        <button class="btn btn-primary" onclick="login()">登入</button>
      </div>
      <div
        id="error-msg"
        class="text-danger mt-3 text-center"
        style="display: none"
      ></div>
    </div>

    <script>
      function login() {
        const account = document.getElementById("account").value.trim();
        const password = document.getElementById("password").value.trim();
        const errorMsg = document.getElementById("error-msg");

        // 清除之前的錯誤訊息
        errorMsg.style.display = "none";
        errorMsg.innerText = "";

        // 前端欄位驗證
        if (!account || !password) {
          errorMsg.innerText = "請填寫帳號與密碼";
          errorMsg.style.display = "block";
          return;
        }

        axios
          .post("http://localhost:8080/api/auth/login", {
            account,
            password,
          })
          .then((res) => {
            if (res.data.code === 200) {
              const token = res.data.result.token;
              localStorage.setItem("token", token);
              window.location.href = "/main.html";
            }
          })
          .catch((err) => {
            const msg = err.response?.data?.message || "登入失敗，請稍後再試";
            errorMsg.innerText = msg;
            errorMsg.style.display = "block";
          });
      }
    </script>
  </body>
</html>
